# MiniSQL 

## 主要目的

MiniSQL是浙江大学数据库课程要求实现的一个简单的SQL管理，主要的要求如下

**任务目标：**

1. 设计并实现一个精简型单用户 SQL 引擎(DBMS) MiniSQL，允许用户通过字符界面输入 SQL 语句实现表的建立/删除；索引的建立/删除以及表记录的插入/删除/查找
2. 通过对 MiniSQL 的设计与实现,提高学生的系统编程能力,加深对数据库管理系统事先技术的理解

**系统需求:**

1. 数据类型：要求支持三种基本数据类型:integer,char(n),float
2. 表定义：一个表可以定义多达 32 个属性,各属性可以指定是否为 unique；支持单属性的主键定义
3. 索引定义：对于表的主属性自动建立 B+树索引,对于声明为 unique 的属性可以通过 SQL 语句由用户指定建立/删除 B+树索引(因此,所有的 B+树索引都是单属性单值的)
4. 数据操作：可以通过指定用 and 连接的多个条件进行查询,支持等值查询和区间

## 主要实现

用go实现比较简单。主要的层次目录是

![](https://gitcode.net/xnzone/solar/-/raw/master/2022/06/1393434.png)

每个组件的功能如下

- interpreter 解释器，把SQL语句解释后，执行相应的命令
- API 连接解释器和底层实现，避免底层暴露过多给用户
- catalog 数据库管理文件，主要是表的一些信息，如表结构字段和索引
- record 数据文件，存数据，主要的数据都在这里，底层接入buffer缓存
- index 索引文件，存索引，主要为了方便查询，底层接入B+树
- buffer 采用带过期的LRU进行缓存。时间过期会落盘，同时代码中也可以控制落盘

相对来说比较简单的用内部初始化的方式。目前已基本写完，但部分功能有点bug，等有时间再修复吧

## 使用

直接`make`编译，查看`bin`目录下的`minisql`就可以运行了。支持简单的SQL，还是同样的问题，有bug未修复

```sql
create table stu(id char(5), name char(8) unique, primary key(id));
quit;
```